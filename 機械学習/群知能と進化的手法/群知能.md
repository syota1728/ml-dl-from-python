# 群知能
  生物にヒントを得た機械学習手法

# １．粒子群最適化法
生物の群れの挙動を模倣  
例）魚や鳥などの生物の群れが餌を探して動き回る様子をシミュレートする  
$`\quad`$ → 最適な移動経路や狩場を発見=最適解が求められる。

## 粒子群最適化法における、粒子運動の条件
(1) 自分の過去の記憶を参照し、過去最も良い評価値を得た場所の周辺に向かって動く

(2) 群れ全体として、過去最も良い評価値を得た場所の周辺に向かって動く

## アルゴリズム
### 問題設定
$M$次元探索空間$`S`$で関数$`F`$の最小値を探索

$` F(x) \le C_1 ,\quad x=(x_1,x_2,\dots,x_m) `$

ただし、$`F`$の最小値は0で、ある閾値$`C_1`$以下となるxを探索  
$`C_1=0`$なら厳密解，$`\quad`$   $`0<C_1`$なら近似解

$`N`$個の粒子群が探索空間$`S`$を動き回って解を探索
$`i`$番目の粒子の位置と速度

・ 位置：$`x_i = (x_1^i,x_2^i,\dots,x_M^i)`$ ←M次元それぞれの位置ベクトル  
・ 速度：$`v_i = (v_1^i,v_2^i,\dots,v_M^i)`$ ←M次元それぞれの速度ベクトル


1. **パーソナルベスト**  
  $`p_i`$：$`i`$番目の粒子の現在までの最良値を与える粒子位置

2. **グローバルベスト**  
  $`g`$：すべての粒子のパーソナルベストの最良値を与える粒子位置

### 各粒子の更新式
位置の更新：$`x_j^i(n+1) = x_j^i(n)+v_j^i(n)`$

速度の更新：$`v_j^i(n+1)=
\underbrace{w v_j^i(n)}_{\text{慣性項}}
+
\underbrace{\rho_1 (p_j^i - x_j^i(n))}_{\text{自己認識項}}
+
\underbrace{\rho_2 (g_j^i - x_j^i(n))}_{\text{社会認識項}}
`$  

- 慣性項：現在進んでいる方向にそのまま進むベクトル
- 自己認識：パーソナルベストへと向かうベクトル
- 社会認識：グローバルベストへと向かうベクトル

粒子の群れが情報を共有して最適値を探し出す

## 活用例
| 分野 | 応用例 |  
| --- | --- |
| 数値最適化 | 関数の最小化・最大化、パラメータ調整 |  
| 機械学習 | ニューラルネットワークの重み最適化 |  
| 金融 | ポートフォリオ最適化、リスク評価モデルのパラメータ最適化 |

<br>

> 目的関数 = 連続関数

<br><br>
---

# 2．蟻コロニー最適化法
蟻が餌場までの最短距離を見つける際に残すフェロモンの仕組みを模倣

複数拠点を巡る際の最短距離を求めるという趣旨の「巡回セールスマン問題」に、良好な性能を示す。

## アルゴリズム
(1) 経路を設定し、すべての経路に対するフェロモン**濃度**を0に初期化する。

(2) 以下を適当な回数繰り返す  
　 (2-1)以下の方法で、すべての蟻を巣穴から餌場まで歩かせる  
　　　 (2-1-1)確率$`ε`$でランダムに経路を選択する  
　 　　(2-1-2)確率 ( 1 - $`ε`$ ) で、フェロモン濃度に応じて経路を選択する  
　 (2-2)以下の方法で、各個体の移動距離に関連して経路上のフェロモン濃度を更新する  
　　　 (2-2-1)フェロモン濃度に定数$`ρ`$を乗じて蒸発させる  
　　　 (2-2-2)各個体の移動距離$`Lm`$を求め、個体の選択した経路に対応するフェロモン濃度に以下の値を加える  
　　　　　　　　$Q×(1/Lm^2)$

　
 ***よく通る道 → フェロモン濃度が高い $`\quad`$ 人気のない道 → フェロモン濃度が低い***  
　　　　　　　　　　　　　　　　 ⇒ 人気の道 = 距離の短い道　≒ 最短距離に近づいていく

確率$`ε`$でランダムに経路を選択する理由： ランダムに選択しなかった場合、その時の最適解は <mark>局所最適解</mark> の可能性があるから、定期的にランダムにすることで全体最適に近づける可能性がある。

### 活用例
| 分野 | 応用例 |  
| --- | --- |
| ルート探索 | 巡回セールスマン問題、配送ルート最適化 |  
| ネットワーク | 通信ネットワークのパス最適化、負荷分散 |  
| 組み合わせ問題 | スケジューリング |
| データマイニング | クラスタリング、特徴選択 |